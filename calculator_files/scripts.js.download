window.cart_options=[];jQuery(document).ready(function($){$('.choice-av-option').on('click',function(){var classItemRem='';var attrItem='';$(this).closest('.choice-all-visible').find('.choice-av-option').removeClass('active');$(this).addClass('active');$('.box-view').removeClass('b-none');if(!$(this).hasClass('tons')){classItemRem='tons';attrItem='amount';}else{attrItem='tons';classItemRem='amount';}
$('.box-view.b-'+classItemRem).addClass('b-none');$('.ajax_push').attr('data-item',attrItem);});$('body .calculation').on('click','.ajax_push',function(){var item=$(this).attr('data-item');var price=$('input.'+item+'-input').val();if(!price.length>0){return '';}
var data={'action':'calculate_ajax_mt','price':price,'type':item,};jQuery.post(wc_add_to_cart_params.ajax_url,data,function(response){var priceMt=new Intl.NumberFormat().format(response);var title='';var titleAjax='';var emissionAjax='';var priceAjax='';if(item==='amount'){title='Offset metric amount';$('.result-total__text').html(priceMt);priceAjax=price;price='$'+price;titleAjax='metric amount';emissionAjax=priceMt;}else{$('.result-total__text').html(price);title='Offset metric tons';priceAjax=priceMt;emissionAjax=price;price=price+' MT';titleAjax='metric tons';}
if(window.cart_options.length>0){var __FOUND=-1;for(var i=0;i<window.cart_options.length;i++){if(window.cart_options[i].type==titleAjax){__FOUND=i;break;}}
if(__FOUND>-1){window.cart_options[__FOUND].emission=priceAjax;}else{window.cart_options.push({'price':priceAjax.replace(',',''),'travel':'Offset','type':titleAjax,'emission':emissionAjax.replace(',','')});}}else{window.cart_options.push({'price':priceAjax.replace(',',''),'travel':'Offset','type':titleAjax,'emission':emissionAjax.replace(',','')});}
$('ul.boat-footprint-append').html('');$('.result__illustration-box').addClass('b-none');$('.result__illustration-box-estimate').removeClass('b-none');$('.metric-ton-final-line>b').html('$'+priceMt);$('.boat-footprint').removeClass('b-none');var initialValueEm=0;var initialValueTotal=0;var sumEmission=window.cart_options.reduce((accumulator,currentValue)=>accumulator+parseFloat(currentValue.emission),initialValueEm);var sumTotal=window.cart_options.reduce((accumulator,currentValue)=>accumulator+parseFloat(currentValue.price),initialValueTotal);$('.emmission-final-total').html('$'+sumTotal);$('.metric-ton-final-total').html(sumEmission+' MT');window.cart_options.forEach(function(value,key){var HTmlprice=value.type==='metric amount'?'$'+value.price:value.emission+' MT';$('<li><span>Offset: '+value.type+' </span><span>\n'+
'                                <span>'+HTmlprice+'\n'+
'                                    <span data-key="'+key+'" class="remove-x">\n'+
'                                        <svg width="8" height="8" viewBox="0 0 8 8" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M7.15035 0.854924C6.95535 0.659924 6.64035 0.659924 6.44535 0.854924L4.00035 3.29492L1.55535 0.849924C1.36035 0.654924 1.04535 0.654924 0.850352 0.849924C0.655352 1.04492 0.655352 1.35992 0.850352 1.55492L3.29535 3.99992L0.850352 6.44492C0.655352 6.63992 0.655352 6.95492 0.850352 7.14992C1.04535 7.34492 1.36035 7.34492 1.55535 7.14992L4.00035 4.70492L6.44535 7.14992C6.64035 7.34492 6.95535 7.34492 7.15035 7.14992C7.34535 6.95492 7.34535 6.63992 7.15035 6.44492L4.70535 3.99992L7.15035 1.55492C7.34035 1.36492 7.34035 1.04492 7.15035 0.854924V0.854924Z" fill="#FF0000"></path></svg>\n'+
'                                    </span>\n'+
'                                </span>\n'+
'                            </span></li>').appendTo('ul.boat-footprint-append');});});});$('body #resultcontainer').on('click','.sti_ajax_add_cart',function(){var $data='';$.get(wc_add_to_cart_params.ajax_url+"?action=get_client_api_key",function(response){var response=JSON.parse(response);let api_key=response.api_key;console.log(api_key);$data=btoa(JSON.stringify({api_key:api_key,domain:window.location.origin,date:new Date().toISOString(),url:window.location.href,cart:window.cart_options,redirect_url:document.location.origin+document.location.pathname}));$.get(wc_add_to_cart_params.ajax_url+"?action=sti_add_product_to_cart&data="+$data,function(response){});});});jQuery(".total_trip_value").on('change keyup',function(){var total_trip_value=jQuery(this).val();var contribution_rate=jQuery('#mkd-container').find('.contribution_rate').val();if(total_trip_value&&contribution_rate)
{var totalamount=(total_trip_value*contribution_rate)/100;jQuery('#amount-input').val(totalamount);}});jQuery('#mkd-container').find('.contribution_rate').on('change keyup',function(){var contribution_rate=jQuery(this).val();var total_trip_value=jQuery('.total_trip_value').val();if(total_trip_value&&contribution_rate)
{var totalamount=(total_trip_value*contribution_rate)/100;jQuery('#amount-input').val(totalamount);}});});